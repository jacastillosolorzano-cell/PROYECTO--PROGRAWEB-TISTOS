import{d as b,j as e,r as o,u as I,a as l}from"./index-DgU88-tE.js";import{l as A}from"./index-CA1CrNgP.js";import{B as d}from"./button-3Wv6xpxF.js";import{O as B}from"./OverlayAnimator-D6RdGLYs.js";import{B as f}from"./config-DABtjQED.js";import{A as H}from"./arrow-left-Db3JbSGu.js";import{G as N}from"./gift-dxCVLfLR.js";const P=b("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);const L=b("Flame",[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]]);const O=b("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);const w=b("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);const W=b("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);const D=b("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]),U=({hoursPerLevel:r,setHoursPerLevel:i})=>{const h=m=>{const s=Math.max(1,Math.min(999,Math.floor(m)||1));i(s)},p=m=>{m.target.blur()};return e.jsxs("div",{style:{background:"#2a2a2a",padding:"14px",borderRadius:"12px",marginBottom:"18px",textAlign:"center",boxShadow:"0 0 12px rgba(255, 102, 204, 0.06)"},children:[e.jsx("h3",{style:{margin:"0 0 10px 0",color:"#e6e6e6",fontSize:15},children:"âš™ï¸ Configurar progresiÃ³n"}),e.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:10},children:[e.jsx("label",{style:{fontSize:14,color:"#d0d0d0"},children:"Horas requeridas por nivel:"}),e.jsxs("div",{style:{display:"inline-flex",alignItems:"center",background:"#111",padding:"6px 8px",borderRadius:8,border:"1px solid rgba(255,255,255,0.04)",minWidth:86},children:[e.jsx("input",{type:"number",min:1,max:999,value:r,onChange:m=>h(Number(m.target.value)),onWheel:p,style:{padding:"6px 6px",borderRadius:6,border:"none",background:"transparent",color:"#fff",width:48,textAlign:"center",fontSize:14,outline:"none"}}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",marginLeft:8},children:[e.jsx("button",{onClick:()=>h(r+1),title:"Incrementar",style:{width:22,height:18,padding:0,margin:0,display:"flex",alignItems:"center",justifyContent:"center",background:"transparent",border:"none",color:"#fff",cursor:"pointer"},children:e.jsx("svg",{width:"10",height:"10",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M12 5l7 7H5l7-7z"})})}),e.jsx("button",{onClick:()=>h(Math.max(1,r-1)),title:"Decrementar",style:{width:22,height:18,padding:0,margin:0,display:"flex",alignItems:"center",justifyContent:"center",background:"transparent",border:"none",color:"#fff",cursor:"pointer"},children:e.jsx("svg",{width:"10",height:"10",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:e.jsx("path",{d:"M12 19l-7-7h14l-7 7z"})})})]})]})]}),e.jsx("p",{style:{marginTop:8,fontSize:12,color:"#9a9a9a"},children:"(Cambia este valor para ajustar la progresiÃ³n)"})]})},$=({hoursDone:r,hoursRequired:i})=>{const n=o.useMemo(()=>i<=0?0:Math.min(100,Math.round(r/i*1e3)/10),[r,i]);return e.jsxs("div",{style:{background:"#2b2b2b",padding:14,borderRadius:10},children:[e.jsx("div",{style:{width:"100%",background:"rgba(0,0,0,0.25)",height:36,borderRadius:10,overflow:"hidden"},children:e.jsx("div",{style:{width:`${n}%`,height:"100%",background:"linear-gradient(90deg,#ff66cc 0%,#b400ff 50%,#7b2cff 100%)",transition:"width 700ms ease"}})}),e.jsxs("div",{style:{textAlign:"center",marginTop:10,color:"#ddd",fontSize:14},children:[r," / ",i," horas (",n,"%)"]})]})},G=({hoursDone:r,level:i})=>e.jsxs("div",{style:{textAlign:"center",marginBottom:12},children:[e.jsxs("div",{style:{color:"#cfc",fontSize:14},children:["Nivel actual: ",e.jsx("strong",{style:{color:"#fff"},children:i})]}),e.jsxs("div",{style:{marginTop:8,fontSize:20,fontWeight:700,background:"linear-gradient(90deg,#ff66cc,#7b2cff)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:["Horas totales transmitidas: ",r]})]}),V=({open:r,level:i,onClose:n})=>r?e.jsxs("div",{style:{position:"fixed",inset:0,zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:[e.jsx("div",{onClick:n,style:{position:"absolute",inset:0,background:"rgba(0,0,0,0.6)"}}),e.jsxs("div",{style:{position:"relative",background:"rgba(20,20,20,0.98)",color:"#fff",padding:"32px 36px",borderRadius:16,boxShadow:"0 0 40px rgba(204, 102, 255, 0.45)",textAlign:"center",maxWidth:420,width:"90%",border:"1px solid rgba(150,80,200,0.25)"},children:[e.jsx("h2",{style:{marginBottom:12,fontSize:22},children:"ğŸ‰ Â¡Felicidades! ğŸ‰"}),e.jsxs("p",{style:{marginBottom:18,fontSize:16},children:["Has subido al ",e.jsxs("b",{children:["nivel ",i]})]}),e.jsx("button",{onClick:n,style:{marginTop:6,background:"linear-gradient(90deg,#ff66cc,#7b2cff)",border:"none",color:"#fff",padding:"10px 20px",borderRadius:999,cursor:"pointer",fontWeight:700},children:"Â¡Genial!"})]})]}):null,k="streamer_hours_done_v1",S="streamer_hours_required_v1",q=5e3,J=()=>{const[r,i]=o.useState(20),[n,g]=o.useState(15),[h,p]=o.useState(!1),m=o.useRef(0);o.useEffect(()=>{const c=localStorage.getItem(k),x=localStorage.getItem(S);c&&g(Number(c)),x&&i(Number(x))},[]),o.useEffect(()=>{localStorage.setItem(k,String(n))},[n]),o.useEffect(()=>{localStorage.setItem(S,String(r))},[r]),o.useEffect(()=>{const c=()=>{document.hidden||g(j=>j+1)},x=window.setInterval(c,q);return()=>window.clearInterval(x)},[]);const s=Math.max(1,Math.floor(n/Math.max(1,r))+1);return o.useEffect(()=>{const c=m.current||Math.max(1,Math.floor(Math.max(0,n-1)/Math.max(1,r))+1);s>c&&p(!0),m.current=s},[s,n,r]),e.jsxs("section",{style:{maxWidth:920,margin:"0 auto",padding:"20px"},children:[e.jsxs("div",{style:{borderRadius:18,padding:28,background:"#151515",boxShadow:"0 0 60px rgba(124,58,237,0.12), inset 0 0 40px rgba(124,58,237,0.04)",border:"1px solid rgba(120,60,160,0.12)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:18},children:[e.jsx("div",{style:{width:36,height:36,borderRadius:8,background:"#222",display:"flex",alignItems:"center",justifyContent:"center"},children:"ğŸ¥"}),e.jsx("h3",{style:{color:"#fff",margin:0,fontSize:20},children:" Mi progreso como Streamer"})]}),e.jsx("div",{style:{marginBottom:12},children:e.jsx(U,{hoursPerLevel:r,setHoursPerLevel:i})}),e.jsx("div",{style:{marginBottom:12},children:e.jsx(G,{hoursDone:n,level:s})}),e.jsx("div",{style:{marginBottom:6},children:e.jsx($,{hoursDone:n%r,hoursRequired:r})}),e.jsx("p",{style:{textAlign:"center",marginTop:12,color:"#bdbdbd",fontSize:13},children:"MantÃ©n tus transmisiones activas para alcanzar el siguiente nivel ğŸ’ª"})]}),e.jsx(V,{open:h,level:s,onClose:()=>p(!1)})]})},K=[{id:1,usuario:"streamer1",texto:"Â¡Bienvenidos al directo! #stream #tistos",vistas:"3.5M",likes:"258.7K",categoria:"Trending",img:"https://picsum.photos/seed/stream1/80/80"},{id:2,usuario:"streamer2",texto:"Hoy hablamos de tecnologÃ­a ğŸš€ #tech",vistas:"6.4M",likes:"446.6K",categoria:"Recommended",img:"https://picsum.photos/seed/stream2/80/80"}],re=()=>{const r=I(),[i,n]=o.useState("inspiracion"),[g,h]=o.useState([]),[p,m]=o.useState(!1),[s,c]=o.useState({nombre:"",costo:"",puntos:""}),[x,j]=o.useState(null),[C,y]=o.useState(!0),u=JSON.parse(localStorage.getItem("tistos_current_user")||"{}").id_usuario;o.useEffect(()=>{u&&(z(),v())},[u]),o.useEffect(()=>{if(!u)return;const t=A(f,{autoConnect:!0});return t.on("connect",()=>{console.log("Socket conectado (frontend):",t.id),t.emit("join_streamer_room",u)}),t.on("gift_received",a=>{const T={type:"gift",from:a.espectador_nombre||a.id_espectador,giftName:a.regalo?.nombre||a.id_regalo||"Regalo",points:a.puntos_otorgados||a.puntos||0,multiplier:a.cantidad||1};window.dispatchEvent(new CustomEvent("tistos:overlay",{detail:T}))}),t.on("disconnect",()=>{console.log("Socket desconectado (frontend)")}),()=>{t.disconnect()}},[u]);const z=async()=>{try{const t=await fetch(`${f}/usuarios/${u}/rol`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({rol:"STREAMER"})});if(t.status===200){const a=await t.json();localStorage.setItem("tistos_current_user",JSON.stringify(a)),l.success("Â¡Bienvenido al modo Streamer!")}else l.error("Error al cambiar al modo streamer")}catch(t){l.error("Error al cambiar al modo streamer"),console.error(t)}},v=async()=>{try{y(!0);const t=await fetch(`${f}/regalos/streamer/${u}`);if(t.status===200){const a=await t.json();h(a)}}catch(t){l.error("Error al cargar los regalos"),console.error(t)}finally{y(!1)}},M=(t,a)=>{m(!0),setTimeout(()=>m(!1),2e3)},E=async t=>{if(t.preventDefault(),!s.nombre||!s.costo||!s.puntos){l.error("Completa todos los campos");return}try{x?(await fetch(`${f}/regalos/${x}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({nombre:s.nombre,costo_monedas:Number(s.costo),puntos_otorgados:Number(s.puntos)})})).status===200?(l.success("Regalo actualizado"),j(null),await v()):l.error("Error al actualizar el regalo"):(await fetch(`${f}/regalos/crear`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({nombre:s.nombre,costo_monedas:Number(s.costo),puntos_otorgados:Number(s.puntos),id_streamer:u})})).status===200?(l.success("Regalo creado"),await v()):l.error("Error al crear el regalo"),c({nombre:"",costo:"",puntos:""})}catch(a){l.error("Error al guardar el regalo"),console.error(a)}},_=t=>{j(t.id_regalo),c({nombre:t.nombre,costo:t.costo_monedas.toString(),puntos:t.puntos_otorgados.toString()})},R=async t=>{try{(await fetch(`${f}/regalos/${t}`,{method:"DELETE"})).status===200?(l.success("Regalo eliminado"),await v()):l.error("Error al eliminar el regalo")}catch(a){l.error("Error al eliminar el regalo"),console.error(a)}};return e.jsxs("div",{className:"min-h-screen bg-background relative pb-20",children:[e.jsx(d,{variant:"ghost",size:"icon",className:"absolute top-4 left-4",onClick:()=>r(-1),children:e.jsx(H,{className:"w-5 h-5"})}),e.jsx("h2",{className:"text-3xl font-bold text-center pt-8 mb-6",children:"Tistos Studio"}),e.jsx(B,{}),e.jsx(J,{}),e.jsxs("div",{className:"max-w-xl mx-auto bg-card rounded-xl p-6 mb-6 shadow flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-bold text-lg",children:"EstadÃ­sticas"}),e.jsx(d,{variant:"link",size:"sm",children:"Ver todo"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-bold text-xl",children:"0"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Visualizaciones"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"0% 7d"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-bold text-xl",children:"0"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Seguidores netos"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"0% 7d"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-bold text-xl",children:"0"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Me gusta"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"0% 7d"})]})]})]}),e.jsxs("div",{className:"max-w-xl mx-auto flex justify-between items-center mb-3 gap-2",children:[e.jsxs(d,{variant:"outline",size:"sm",className:"flex-1 gap-2",children:[e.jsx(D,{className:"w-4 h-4"})," Verificar cuenta"]}),e.jsxs(d,{variant:"outline",size:"sm",className:"flex-1 gap-2",children:[e.jsx(O,{className:"w-4 h-4"})," Academia de creadores"]})]}),e.jsx("div",{className:"max-w-xl mx-auto flex justify-between items-center mb-6 gap-2",children:e.jsxs(d,{variant:"outline",size:"sm",className:"flex-1 gap-2",children:[e.jsx(L,{className:"w-4 h-4"})," Promocionar"]})}),e.jsx("div",{className:"max-w-xl mx-auto flex mb-4 gap-2",children:e.jsx(d,{variant:i==="monetizacion"?"secondary":"outline",size:"sm",className:"flex-1",onClick:()=>n("monetizacion"),children:"MonetizaciÃ³n"})}),e.jsxs("div",{className:"max-w-xl mx-auto flex gap-2 mb-6",children:[e.jsx(d,{variant:"outline",size:"sm",children:"Trending"}),e.jsx(d,{variant:"outline",size:"sm",children:"Recommended"})]}),e.jsx("div",{className:"max-w-xl mx-auto mb-8",children:K.map((t,a)=>e.jsxs("div",{className:"flex items-center gap-3 py-3 border-b border-border",children:[e.jsx("span",{className:"font-bold text-primary",children:a+1}),e.jsx("img",{src:t.img,alt:t.usuario,className:"w-12 h-12 rounded-lg object-cover"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold",children:t.texto}),e.jsxs("div",{className:"text-xs text-muted-foreground flex gap-2",children:[e.jsxs("span",{children:["ğŸ‘ï¸ ",t.vistas]}),e.jsxs("span",{children:["â¤ï¸ ",t.likes]})]})]}),e.jsx(d,{variant:"ghost",size:"icon",onClick:()=>M("Rosa",t.usuario),children:e.jsx(N,{className:"w-5 h-5 text-primary"})})]},t.id))}),e.jsxs("div",{className:"max-w-xl mx-auto bg-card rounded-xl p-6 mb-8",children:[e.jsxs("h3",{className:"font-bold mb-4 flex items-center gap-2",children:[e.jsx(N,{className:"w-5 h-5 text-primary"})," Regalos del canal"]}),e.jsxs("form",{onSubmit:E,className:"flex gap-2 mb-4",children:[e.jsx("input",{type:"text",placeholder:"Nombre",className:"border rounded  w-15 bg-background",value:s.nombre,onChange:t=>c({...s,nombre:t.target.value})}),e.jsx("input",{type:"number",placeholder:"Costo",className:"border rounded w-12 bg-background",value:s.costo,onChange:t=>c({...s,costo:t.target.value})}),e.jsx("input",{type:"number",placeholder:"Puntos",className:"border rounded px-2 py-1 w-20 bg-background",value:s.puntos,onChange:t=>c({...s,puntos:t.target.value})}),e.jsx(d,{type:"submit",size:"sm",variant:"secondary",children:x?e.jsx(w,{className:"w-4 h-4"}):e.jsx(P,{className:"w-4 h-4"})})]}),e.jsx("div",{children:C?e.jsx("p",{className:"text-muted-foreground",children:"Cargando regalos..."}):g.length===0?e.jsx("p",{className:"text-muted-foreground",children:"No hay regalos. Crea uno para comenzar."}):g.map(t=>e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"font-semibold",children:t.nombre}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Costo: ",t.costo_monedas]}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Puntos: ",t.puntos_otorgados]}),e.jsx(d,{variant:"ghost",size:"icon",onClick:()=>_(t),children:e.jsx(w,{className:"w-4 h-4"})}),e.jsx(d,{variant:"ghost",size:"icon",onClick:()=>R(t.id_regalo),children:e.jsx(W,{className:"w-4 h-4 text-red-500"})})]},t.id_regalo))})]}),p&&e.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50 pointer-events-none",children:e.jsxs("div",{className:"bg-primary text-white px-8 py-6 rounded-2xl shadow-lg animate-bounce text-center text-xl font-bold",children:["Â¡Has recibido un regalo!",e.jsx("div",{className:"mt-2 text-base",children:"ğŸ Gracias por tu apoyo"})]})})]})};export{re as default};
