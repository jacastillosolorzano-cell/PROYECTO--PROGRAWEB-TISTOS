import{j as e,u as _,i as F,r as t,B as M}from"./index-Cw9brnzF.js";import{B as u}from"./button-BxQx3nAy.js";import{B as H}from"./BottomNav-BEJvCejP.js";import{A as q}from"./arrow-left-Db4MT3BM.js";import{C as U}from"./coins-HG9cs3N2.js";const V=({isOpen:c,onClose:l,amount:x})=>c?e.jsx("div",{style:{position:"fixed",inset:0,backgroundColor:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:50},children:e.jsxs("div",{style:{backgroundColor:"white",padding:"20px",borderRadius:"8px",maxWidth:"400px",width:"100%",color:"black"},children:[e.jsx("h3",{style:{fontSize:"18px",fontWeight:"bold",marginBottom:"16px"},children:"Comprobante de recarga"}),e.jsxs("p",{style:{fontSize:"14px",marginBottom:"8px"},children:[e.jsx("strong",{children:"Monedas recargadas:"})," ",x," monedas"]}),e.jsxs("p",{style:{fontSize:"14px",marginBottom:"8px"},children:[e.jsx("strong",{children:"Fecha:"})," ",new Date().toLocaleString()]}),e.jsxs("p",{style:{fontSize:"14px",marginBottom:"8px"},children:[e.jsx("strong",{children:"Estado:"})," Completado"]}),e.jsx("p",{style:{fontSize:"14px",marginBottom:"16px"},children:"춰Pago procesado exitosamente! Tu saldo ha sido actualizado. El detalle del monto en soles est치 disponible en tu historial de transacciones."}),e.jsx("button",{onClick:l,style:{width:"100%",padding:"8px",backgroundColor:"#10b981",color:"white",border:"none",borderRadius:"4px",fontWeight:500},children:"Cerrar"})]})}):null,K=({isOpen:c,onClose:l,onSubmit:x,rechargeAmount:a,rechargePrice:s,cardNumber:f,setCardNumber:b,expiryDate:y,setExpiryDate:j,cvc:S,setCvc:h,isProcessing:r})=>{if(!c)return null;const g=s.toFixed(2);return e.jsx("div",{style:{position:"fixed",inset:0,backgroundColor:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:50},children:e.jsxs("div",{style:{backgroundColor:"white",padding:"20px",borderRadius:"8px",maxWidth:"400px",width:"100%",color:"black"},children:[e.jsx("h3",{style:{fontSize:"18px",fontWeight:"bold",marginBottom:"12px"},children:"Informaci칩n de pago seguro"}),a>0&&e.jsxs("p",{style:{fontSize:"14px",marginBottom:"4px"},children:["Est치s recargando ",e.jsx("strong",{children:a})," monedas."]}),e.jsxs("p",{style:{fontSize:"14px",marginBottom:"16px"},children:["Monto a pagar: ",e.jsxs("strong",{children:["S/ ",g]})]}),e.jsxs("form",{onSubmit:x,style:{display:"flex",flexDirection:"column",gap:"16px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:500,marginBottom:4},children:"N칰mero de tarjeta"}),e.jsx("input",{type:"text",value:f,onChange:d=>b(d.target.value),placeholder:"1234 5678 9012 3456",style:{width:"100%",padding:"8px",border:"1px solid #ccc",borderRadius:"4px"},maxLength:19})]}),e.jsxs("div",{style:{display:"flex",gap:"8px"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:500,marginBottom:4},children:"Fecha de expiraci칩n"}),e.jsx("input",{type:"text",value:y,onChange:d=>j(d.target.value),placeholder:"MM/AA",style:{width:"100%",padding:"8px",border:"1px solid #ccc",borderRadius:"4px"},maxLength:5})]}),e.jsxs("div",{style:{flex:1},children:[e.jsx("label",{style:{display:"block",fontSize:"14px",fontWeight:500,marginBottom:4},children:"CVC"}),e.jsx("input",{type:"text",value:S,onChange:d=>h(d.target.value),placeholder:"123",style:{width:"100%",padding:"8px",border:"1px solid #ccc",borderRadius:"4px"},maxLength:3})]})]}),e.jsx("button",{type:"submit",disabled:r,style:{width:"100%",padding:"8px",backgroundColor:"#3b82f6",color:"white",border:"none",borderRadius:"4px",fontWeight:600,cursor:r?"default":"pointer",opacity:r?.8:1},children:r?"Procesando pago...":`Pagar S/ ${g}`})]}),e.jsx("button",{onClick:l,type:"button",style:{marginTop:"16px",width:"100%",padding:"8px",backgroundColor:"#d1d5db",color:"black",border:"none",borderRadius:"4px",fontWeight:500,cursor:"pointer"},children:"Cancelar"})]})})},J=[{id:1,monedas:100,precio:5,descripcion:"Paquete B치sico"},{id:2,monedas:500,precio:20,descripcion:"Paquete Est치ndar"},{id:3,monedas:1e3,precio:35,descripcion:"Paquete Premium"},{id:4,monedas:2e3,precio:60,descripcion:"Paquete VIP"},{id:5,monedas:5e3,precio:120,descripcion:"Paquete Elite"},{id:6,monedas:1e4,precio:200,descripcion:"Paquete Legendario"}],G=({isOpen:c,onClose:l,onSelectPackage:x})=>c?e.jsx("div",{style:{position:"fixed",inset:0,backgroundColor:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:50},children:e.jsxs("div",{style:{backgroundColor:"white",padding:"20px",borderRadius:"8px",maxWidth:"600px",width:"100%",color:"black"},children:[e.jsx("h3",{style:{fontSize:"18px",fontWeight:"bold",marginBottom:"16px"},children:"Selecciona un paquete de monedas"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"16px"},children:J.map(a=>e.jsxs("div",{style:{border:"1px solid #ccc",padding:"12px",borderRadius:"8px",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"24px",marginBottom:"8px"},children:"游눯"}),e.jsx("h4",{style:{fontSize:"16px",fontWeight:"bold"},children:a.descripcion}),e.jsxs("p",{style:{marginTop:4,marginBottom:8},children:[a.monedas," monedas por"," ",e.jsxs("strong",{children:["S/ ",a.precio.toFixed(2)]})]}),e.jsx(u,{onClick:()=>{x(a.monedas,a.precio),l()},style:{marginTop:"8px",width:"100%"},children:"Seleccionar"})]},a.id))}),e.jsx(u,{variant:"ghost",onClick:l,style:{marginTop:"16px",width:"100%"},children:"Cancelar"})]})}):null,ae=()=>{const c=_(),{saldo:l,refrescarSaldo:x}=F(),[a,s]=t.useState(""),[f,b]=t.useState([]),[y,j]=t.useState(!1),[S,h]=t.useState(!1),[r,g]=t.useState(0),[d,w]=t.useState(0),[k,N]=t.useState(""),[z,P]=t.useState(""),[B,R]=t.useState(""),[A,C]=t.useState(!1),[I,E]=t.useState(!1),T=()=>{j(!0)},W=(n,o)=>{g(n),w(o),h(!0)},O=()=>{h(!1),g(0),w(0),N(""),P(""),R(""),s("")},$=()=>{j(!1)},D=()=>{E(!1)},L=async n=>{if(n.preventDefault(),!(r>0&&k&&z&&B)){s("Por favor, completa todos los campos y un monto mayor a 0");return}try{if(C(!0),s(""),!localStorage.getItem("usuario")){s("Debes iniciar sesi칩n para recargar"),C(!1);return}const m=await fetch(`${M}/recargas`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("authToken")||""}`},body:JSON.stringify({monedas_compradas:r,monto_pagado:d,moneda:"PEN",pasarela:"FAKE-PASARELA"})});if(!m.ok){const i=await m.json().catch(()=>({}));throw new Error(i.error||"Error al procesar la recarga")}const p=await m.json();await x(),s(`춰Recarga exitosa! Has agregado ${p.recarga.monedas_compradas} monedas.`);const v={fecha:new Date(p.recarga.fecha_hora).toLocaleString(),descripcion:`Recarga de ${p.recarga.monedas_compradas} monedas`,monto:`${p.recarga.monto_pagado.toFixed(2)} ${p.recarga.moneda}`,estado:p.recarga.estado};b(i=>[v,...i]),h(!1),setTimeout(()=>E(!0),100),setTimeout(()=>s(""),3e3)}catch(o){s(o.message||"Error al procesar la recarga")}finally{C(!1)}};return t.useEffect(()=>{(async()=>{try{const o=localStorage.getItem("authToken");if(!o)return;const m=await fetch(`${M}/recargas/historial`,{headers:{Authorization:`Bearer ${o}`}});if(!m.ok){console.warn("No se pudo obtener el historial de recargas");return}const v=(await m.json()).map(i=>({fecha:new Date(i.fecha_hora).toLocaleString(),descripcion:`Recarga de ${i.monedas_compradas} monedas`,monto:`${i.monto_pagado.toFixed(2)} ${i.moneda}`,estado:i.estado}));b(v)}catch(o){console.error("Error al cargar historial de recargas:",o)}})()},[]),e.jsxs("div",{className:"min-h-screen bg-background relative flex flex-col pb-20",children:[e.jsx(u,{variant:"ghost",size:"icon",className:"absolute top-4 left-4 z-10",onClick:()=>c(-1),children:e.jsx(q,{className:"w-5 h-5"})}),e.jsx("h2",{className:"text-3xl font-bold text-center pt-8 mb-4",children:"Saldo de ulima123"}),e.jsxs("div",{className:"max-w-xl mx-auto bg-card rounded-xl p-6 mb-4 shadow flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"font-bold text-lg flex items-center gap-2",children:[e.jsx(U,{className:"w-6 h-6 text-yellow-400"})," Monedas"]}),e.jsx(u,{variant:"link",size:"sm",onClick:T,children:"Recargar monto"})]}),e.jsxs("div",{className:"flex items-center justify-left gap-4",children:[e.jsx("span",{className:"text-muted-foreground",children:"Saldo"}),e.jsxs("span",{className:"text-2xl font-bold",children:[l," monedas"]})]})]}),a&&e.jsx("div",{className:"max-w-xl mx-auto mb-2 text-center text-primary font-semibold",children:a}),e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsx("div",{className:"border-b-2 border-white pb-2 mb-4 flex items-center justify-between",children:e.jsx("h1",{className:"text-2xl font-bold text-pink-600",children:"Historial de Transacciones"})}),e.jsx("div",{className:"max-h-80 overflow-y-auto rounded-lg border border-gray-300",children:e.jsxs("table",{className:"table table-striped",border:1,style:{width:"100%",textAlign:"left",borderCollapse:"collapse"},children:[e.jsx("thead",{className:"sticky top-0 bg-black text-pink-600 font-semibold",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-2",children:"Fecha"}),e.jsx("th",{className:"p-2",children:"Descripci칩n"}),e.jsx("th",{className:"p-2",children:"Monto"}),e.jsx("th",{className:"p-2",children:"Estado"})]})}),e.jsx("tbody",{children:f.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:4,style:{textAlign:"center"},children:"A칰n no se realizan transacciones"})}):f.map((n,o)=>e.jsxs("tr",{children:[e.jsx("td",{children:n.fecha}),e.jsx("td",{children:n.descripcion}),e.jsx("td",{style:{color:"green",fontWeight:"bold"},children:n.monto}),e.jsx("td",{children:n.estado})]},o))})]})})]}),e.jsx("div",{className:"max-w-xl mx-auto mb-4 mt-4",children:e.jsxs("div",{className:"bg-card rounded-xl p-4 mb-2 flex items-center justify-between",children:[e.jsx("span",{className:"font-bold",children:"Monetizaci칩n"}),e.jsx(u,{variant:"link",size:"sm",children:"Ver m치s"})]})}),e.jsx(G,{isOpen:y,onClose:$,onSelectPackage:W}),e.jsx(K,{isOpen:S,onClose:O,onSubmit:L,rechargeAmount:r,rechargePrice:d,cardNumber:k,setCardNumber:N,expiryDate:z,setExpiryDate:P,cvc:B,setCvc:R,isProcessing:A}),e.jsx(V,{isOpen:I,onClose:D,amount:r}),e.jsx("div",{className:"mt-auto",children:e.jsx(H,{})})]})};export{ae as default};
