import{d as g,r as o,j as e,X as C,u as A,B as v}from"./index-B6pz0rYB.js";import{B as b}from"./button-BxsxkGX6.js";import{S as B,M as S,B as E}from"./BottomNav-CRkurQJ_.js";import{S as L}from"./star-C-OXAFVE.js";import{H as M}from"./HeaderSaldo-d3fzMjoQ.js";import{A as J}from"./arrow-left-B3Gyw0eD.js";import"./coins-6t4k6yzJ.js";const $=g("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);const q=g("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),z=({searchOpen:r,setSearchOpen:i,searchQuery:t,setSearchQuery:l,onEnter:m,filteredChats:c=[]})=>{const d=o.useRef(null);return o.useEffect(()=>{r&&d.current?.focus()},[r]),o.useEffect(()=>{const n=x=>{x.key==="Escape"&&r&&(i(!1),l(""))};return window.addEventListener("keydown",n),()=>window.removeEventListener("keydown",n)},[r,i,l]),e.jsxs("div",{className:"flex-none",children:[e.jsx(b,{variant:"ghost",size:"icon",onClick:()=>{const n=!r;i(n),n&&setTimeout(()=>d.current?.focus(),50)},children:e.jsx(B,{className:"w-5 h-5"})}),r&&e.jsx("div",{className:"absolute top-16 left-4 right-4 z-10 bg-card p-2 rounded-md shadow-lg",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{ref:d,value:t,onChange:n=>l(n.target.value),placeholder:"Buscar chats o mensajes...",className:"w-full px-3 py-2 rounded-md bg-background text-white outline-none",onKeyDown:n=>{n.key==="Enter"&&c.length===1&&m&&m(c)}}),e.jsx("button",{onClick:()=>{i(!1),l("")},className:"p-2 rounded-md bg-transparent","aria-label":"Cerrar búsqueda",children:e.jsx(C,{className:"w-4 h-4 text-muted-foreground"})})]})})]})},H=({chats:r,onChatClick:i})=>e.jsxs("div",{children:[r.map(t=>e.jsxs("div",{className:"flex items-center gap-3 py-2 border-b border-border cursor-pointer hover:bg-muted rounded p-2",onClick:()=>i(t),children:[t.avatar?e.jsx("img",{src:t.avatar,alt:t.nombre,className:"w-10 h-10 rounded-full"}):e.jsx("div",{className:"w-10 h-10 rounded-full bg-secondary flex items-center justify-center text-white text-sm font-bold",children:t.nombre.charAt(0).toUpperCase()}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"font-semibold text-sm flex items-center gap-1",children:[t.nombre,typeof t.level=="number"&&e.jsxs(e.Fragment,{children:[e.jsxs("span",{className:"text-xs text-muted-foreground",children:["· Nivel ",t.level]}),e.jsx(L,{className:"w-3 h-3 text-yellow-500"})]})]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:t.mensaje})]}),e.jsx(S,{className:"w-5 h-5 text-muted-foreground"})]},t.id)),r.length===0&&e.jsx("div",{className:"py-8 text-center text-muted-foreground",children:"No se encontraron conversaciones."})]}),N=[{id:1,nombre:"Juler1",mensaje:"Se envió ayer",avatar:"https://api.dicebear.com/7.x/avataaars/svg?seed=Allison",level:3},{id:2,nombre:"Hernan2",mensaje:"JAJAJAJAJAJA",avatar:"https://api.dicebear.com/7.x/avataaars/svg?seed=Lexandra",level:7},{id:3,nombre:"Fiorella",mensaje:"Visto",avatar:"https://api.dicebear.com/7.x/avataaars/svg?seed=Boom",level:5}],F=()=>{const r=A(),[i,t]=o.useState(""),[l,m]=o.useState(!1),[c,d]=o.useState([]),[n,x]=o.useState(!1),p=o.useMemo(()=>{const s=i.trim().toLowerCase();return s?N.filter(a=>a.nombre.toLowerCase().includes(s)||a.mensaje.toLowerCase().includes(s)):N},[i]),j=o.useMemo(()=>c.filter(s=>!s.leido).length,[c]),y=s=>{r(`/chat/${s.id}`,{state:{chat:s}})},w=s=>{const a=s[0];a&&r(`/chat/${a.id}`,{state:{chat:a}})};o.useEffect(()=>{(async()=>{try{const a=localStorage.getItem("authToken");if(!a)return;x(!0);const f=await fetch(`${v}/notificaciones`,{headers:{Authorization:`Bearer ${a}`}});if(!f.ok){console.warn("No se pudieron cargar las notificaciones");return}const u=await f.json();d(u)}catch(a){console.error("Error obteniendo notificaciones:",a)}finally{x(!1)}})()},[]);const k=async s=>{try{const a=localStorage.getItem("authToken");if(!a)return;if(!(await fetch(`${v}/notificaciones/${s}/leido`,{method:"POST",headers:{Authorization:`Bearer ${a}`}})).ok){console.warn("No se pudo marcar notificación como leída");return}d(u=>u.map(h=>h.id_notificacion===s?{...h,leido:!0}:h))}catch(a){console.error("Error marcando notificación como leída:",a)}};return e.jsxs("div",{className:"min-h-screen bg-background flex flex-col pb-20",children:[e.jsxs("div",{className:"flex items-center gap-2 p-4",children:[e.jsx(b,{variant:"ghost",size:"icon",onClick:()=>r(-1),children:e.jsx(J,{className:"w-5 h-5"})}),e.jsx("div",{className:"flex-1 flex items-center justify-center",children:l?null:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Mensajes"}),e.jsx(M,{})]})}),e.jsx(z,{searchOpen:l,setSearchOpen:m,searchQuery:i,setSearchQuery:t,onEnter:w,filteredChats:p})]}),e.jsxs("div",{className:"px-6 space-y-4",children:[e.jsxs("div",{className:"flex gap-4 mb-2",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"w-14 h-14 rounded-full bg-secondary flex items-center justify-center text-white text-xl font-bold",children:"U"}),e.jsx("span",{className:"text-xs mt-1",children:"Crear"})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("img",{src:"https://api.dicebear.com/7.x/avataaars/svg?seed=Sebastian",alt:"Sebastian",className:"w-14 h-14 rounded-full border-2 border-primary"}),e.jsx("span",{className:"text-xs mt-1",children:"Andrea"})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("img",{src:"https://api.dicebear.com/7.x/avataaars/svg?seed=Billy",alt:"Billy",className:"w-14 h-14 rounded-full border-2 border-primary"}),e.jsx("span",{className:"text-xs mt-1",children:"Billy"})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("img",{src:"https://api.dicebear.com/7.x/avataaars/svg?seed=ElCarlin",alt:"ElCarlin",className:"w-14 h-14 rounded-full border-2 border-primary"}),e.jsx("span",{className:"text-xs mt-1",children:"Jim"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(q,{className:"w-5 h-5 text-primary"}),e.jsx("span",{className:"font-semibold",children:"Nuevos seguidores"})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx($,{className:"w-5 h-5 text-pink-500"}),j>0&&e.jsx("span",{className:"absolute -top-2 -right-2 bg-red-500 text-white text-[10px] rounded-full px-1",children:j})]}),e.jsx("span",{className:"font-semibold",children:"Actividad"})]}),e.jsxs("div",{className:"space-y-2 mt-2",children:[n&&e.jsx("p",{className:"text-xs text-muted-foreground",children:"Cargando actividad..."}),!n&&c.length===0&&e.jsx("p",{className:"text-xs text-muted-foreground",children:"No tienes actividad reciente."}),!n&&c.map(s=>e.jsxs("div",{className:`p-3 rounded-lg bg-card border flex items-start justify-between gap-3 ${s.leido?"border-border":"border-primary"}`,children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm",children:s.mensaje}),e.jsx("p",{className:"text-[10px] text-muted-foreground mt-1",children:new Date(s.fecha_hora).toLocaleString()})]}),!s.leido&&e.jsx("button",{className:"text-xs text-primary underline",onClick:()=>k(s.id_notificacion),children:"Marcar como leída"})]},s.id_notificacion))]})]}),e.jsx(H,{chats:p,onChatClick:y})]}),e.jsx("div",{className:"mt-auto",children:e.jsx(E,{})})]})};export{F as default};
